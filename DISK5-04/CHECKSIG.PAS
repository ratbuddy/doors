PROGRAM CHECKSIGN;
TYPE HELPER=STRING[75];
type signer=record
  Descrip: helper;
  chatsay: helper;
  dlocx  : byte;
  dlocy  : byte;
  dymap  : byte;
  dxmap  : byte;
  dunglvl: byte;
  outdun : boolean; {TRUE for OUTDOOR, FALSE for DUNGEON!}
  end;


VAR MAPFILE : FILE OF CHAR;
    MAPARRAY : ARRAY [1..80,1..23] OF CHAR;
    COUNT1,COUNT2,COUNT3:INTEGER;
    FILENAME:STRING[12];
    SIGN:SIGNER;
    SIG_FILE:FILE OF SIGNER;

PROCEDURE START_OUT_DOORS;

   PROCEDURE CHECKSIG_OUT(A,B,C,D:INTEGER);
   VAR FOUND:BOOLEAN; SHIT:CHAR;
   BEGIN
   RESET(SIG_FILE);
   FOUND:=FALSE;
   REPEAT
   {$i-}
   READ(SIG_FILE,SIGN);
   {$i+}
   IF IORESULT<>0 THEN BEGIN
      WRITELN('ERROR AT WILDER',C,D,'.PIT   X=',A,'   Y=',B);
      WRITELN('PRESS RETURN TO CONTINUE');
      READ(SHIT); FOUND:=TRUE;
      END ELSE
   IF SIGN.DLOCX=A THEN
    IF SIGN.DLOCY=B THEN
     IF SIGN.DYMAP=D THEN
      IF SIGN.DXMAP = C THEN
       IF SIGN.OUTDUN THEN
       FOUND:=TRUE;
   UNTIL FOUND;
   END;

VAR X,Y:INTEGER;
BEGIN
 FOR COUNT1:=1 TO 9 DO
   FOR COUNT2:=1 TO 9 DO BEGIN
     FILENAME:='WILDER'+CHR(COUNT1+48)+CHR(COUNT2+48)+'.PIT';
     WRITELN('READING..... ',FILENAME);
     ASSIGN(MAPFILE,FILENAME);
     {$I-}
     RESET(MAPFILE);
     {$I+}
     IF IORESULT=0 THEN BEGIN
       WRITELN('SCANNING.......');
       FOR Y:=1 TO 23 DO
        FOR X:=1 TO 80 DO
          READ(MAPFILE,MAPARRAY[X,Y]);
       CLOSE(MAPFILE);
       FOR Y:=1 TO 23 DO
         FOR X:=1 TO 80 DO
          IF MAPARRAY[X,Y]='â' THEN CHECKSIG_OUT(X,Y,COUNT1,COUNT2);
     END;
  END;
END;

PROCEDURE START_IN_DUNG;
   PROCEDURE CHECKSIG_DUN(A,B,C,D,E:INTEGER);
   VAR FOUND:BOOLEAN; SHIT:CHAR;
   BEGIN
   RESET(SIG_FILE);
   FOUND:=FALSE;
   REPEAT
   {$i-}
   READ(SIG_FILE,SIGN);
   {$i+}
   IF IORESULT<>0 THEN BEGIN
      WRITELN('ERROR AT LVL',E,C,D,'.DNG   X=',A,'   Y=',B);
      WRITELN('PRESS RETURN TO CONTINUE');
      READ(SHIT); FOUND:=TRUE;
      END ELSE
  IF SIGN.DUNGLVL=E THEN
   IF SIGN.DLOCX=A THEN
    IF SIGN.DLOCY=B THEN
     IF SIGN.DYMAP=D THEN
      IF SIGN.DXMAP = C THEN
       IF NOT SIGN.OUTDUN THEN
       FOUND:=TRUE;
   UNTIL FOUND;
   END;

VAR X,Y:INTEGER;


BEGIN
 FOR COUNT1:=1 TO 4 DO
  FOR COUNT2:=0 TO 9 DO
    FOR COUNT3:=0 TO 9 DO BEGIN
     FILENAME:='LVL'+CHR(COUNT1+48)+CHR(COUNT2+48)+CHR(COUNT3+48)+'.DNG';
     WRITELN('READING..... ',FILENAME);
     ASSIGN(MAPFILE,FILENAME);
     {$I-}
     RESET(MAPFILE);
     {$I+}
     IF IORESULT=0 THEN BEGIN
       WRITELN('SCANNING.......');
       FOR Y:=1 TO 23 DO
        FOR X:=1 TO 80 DO
          READ(MAPFILE,MAPARRAY[X,Y]);
       CLOSE(MAPFILE);
       FOR Y:=1 TO 23 DO
         FOR X:=1 TO 80 DO
          IF MAPARRAY[X,Y]='â' THEN CHECKSIG_DUN(X,Y,COUNT2,COUNT3,COUNT1);
     END;
  END;
END;

BEGIN
ASSIGN(SIG_FILE,'SIGNS.PIT');
RESET(SIG_FILE);
START_OUT_DOORS;
START_IN_DUNG;
CLOSE(SIG_FILE);
END.